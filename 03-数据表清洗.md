# 03-数据表清洗



## 行与列的清洗

### 更改列名

```python
# 更改列名称
df.rename(columns={'category': 'category-size',
                   'id':'user_id'}, inplace = True) 

# 批量更改列名
df.columns=['Z_'+i for i in df.columns]
df.columns=[i.replace('_woe','') for i in df.columns]
```

<br/>

### 删除行与列

```python
# 删除含有重复值的行
df.drop_duplicates(inplace = True)              #保留重复的第一项
df.drop_duplicates(keep='last', inplace = True) #保留重复的最后一项
df = df.drop_duplicates(subset=['category'])    #按某一列去重

# 删除列
df.drop(['mob_province_x', 'order_id'], axis=1, inplace=True)

# 删除列名中含有'mob0'的列
if 'mob0' in df.columns.tolist():
    df = df.drop('mob0', axis=1)  # 删除mob0

# 删除常数列
df = df.loc[:, df.apply(pd.Series.nunique)!=1]
```

<br/>

------

## 缺失值清洗

### 缺失值可视化

```python
# Jupyter Notebook中内嵌画图 %matplotlib inline
import missingno as msno
msno.matrix(df) #缺失矩阵
msno.bar(df) #缺失条形图
```

<br/>

### 删除含有空值的行或列

```python
# 删除所有含缺失值的行
df = df.dropna()

# 删除数据表中整行都是空值的行
df = df.dropna(how='all') 

# 删除所有含缺失值的列
df = df.dropna(axis=1)

# 删除缺失比例0.8以上的变量
df = df.dropna(thresh=len(df)*0.2, axis=1)
```

<br/>

### 用特定值填充空值

```python
# 使用数字-999填充数据表中空值
df.fillna(-999)

# 对某一列进行填充
df.fillna({'price':0})

# 将0值替换为None
df['price'] = df['price'].map(lambda x: x if x != 0 else None)
# 多列同时替换
columns = ['price', 'city', 'category']
for col in columns:
    df[col].replace([0], [None], inplace=True)

# 替换为标准缺失值格式
for col in columns:
    df[col].replace([None,'未知'], np.nan, inplace=True)
    df[col] = df[col].astype('float')
```

<br/>

### 用统计方法填充缺失值

```python
#使用price均值对NA进行填充
df['price'].fillna(df['price'].mean(), inplace = True)

# 使用sklearn的Imputer缺失值填充
from sklearn.preprocessing import Imputer
imr = Imputer(strategy= 'median') # 'mean'
imr = imr.fit(df)
df_imr = imr.transform(df)
df_imr = pd.DataFrame(df_imr, columns = list(df.columns))
```

<br/>

------

## 数据格式清洗







## 







<br/>

------

## 时间日期格式清洗

